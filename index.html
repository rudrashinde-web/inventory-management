<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Daru Inventory Management</title>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; margin: 40px; background-color: #f4f7f6; }
    .container { max-width: 1100px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    
    .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
    .stat-card { background: #fff; padding: 20px; border-radius: 8px; border-left: 5px solid #007bff; box-shadow: 0 2px 5px rgba(0,0,0,0.05); text-align: center; }
    .stat-card h3 { margin: 0; font-size: 0.9rem; color: #666; text-transform: uppercase; }
    .stat-card p { margin: 10px 0 0; font-size: 1.5rem; font-weight: bold; color: #333; }
    
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
    th { background-color: #007bff; color: white; }
    
    form { margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap; align-items: flex-end; background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #eee; }
    .input-group { display: flex; flex-direction: column; }
    label { font-size: 12px; font-weight: bold; margin-bottom: 5px; color: #666; }
    select { padding: 8px; border-radius: 4px; border: 1px solid #ccc; min-width: 120px; }
    
    .badge { padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; color: white; }
    .badge-entry { background-color: #28a745; }
    .badge-exit { background-color: #dc3545; }

    button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
    .delete-btn { background-color: #dc3545; border-radius: 4px; padding: 6px 10px; color: white; border: none; cursor: pointer; }
    
    #stockWarning { color: #dc3545; font-size: 12px; font-weight: bold; margin-top: 5px; display: block; }
    .clear-storage { background-color: #6c757d; margin-top: 20px; font-size: 10px; opacity: 0.6; color: white; border: none; padding: 5px; cursor: pointer; }
  </style>
</head>
<body>

<div class="container">
  <h1>Daru Inventory Dashboard</h1>

  <div class="dashboard">
    <div class="stat-card">
      <h3>Total Bottles In Stock</h3>
      <p id="totalQty">0</p>
    </div>
    <div class="stat-card" style="border-left-color: #28a745;">
      <h3>Total Valuation</h3>
      <p id="totalVal">₹0</p>
    </div>
    <div class="stat-card" style="border-left-color: #ffc107;">
      <h3>Brands</h3>
      <p id="uniqueCount">0</p>
    </div>
  </div>

  <h2>Add New Transaction</h2>
  <form id="addForm">
    <div class="input-group">
      <label>Type</label>
      <select id="type" required>
        <option value="ENTRY">ENTRY (In)</option>
        <option value="EXIT">EXIT (Out)</option>
      </select>
    </div>

    <div class="input-group">
      <label>Item Name</label>
      <select id="name" required onchange="checkAvailableStock()">
        <option value="">Select Code</option>
        <option value="IB">IB</option>
        <option value="RS">RS</option>
        <option value="RC">RC</option>
        <option value="MD">MD</option>
        <option value="OC BLUE">OC BLUE</option>
        <option value="GREEN LABEL">GREEN LABEL</option>
        <option value="R.GREEN">R.GREEN</option>
        <option value="ICONIC W.">ICONIC E.</option>
        <option value="MD RUM">MD RUM</option>
        <option value="DSP">DSP</option>
        <option value="B7">B7</option>
        <option value="ROMANOV">ROMANOV</option>
        <option value="MAGIC MOVE.">OC</option>
        <option value="DR.BANDY">DR.BANDY</option>
        <option value="GOA FIN">GOA GIN</option>
        <option value="GRANDMASTER FAV.">GF</option>
      </select>
      <span id="stockWarning"></span>
    </div>

    <div class="input-group">
      <label>Quantity</label>
      <select id="quantity" required>
        <option value="">Select Qty</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="6">6</option>
        <option value="10">10</option>
        <option value="12">12</option>
        <option value="24">24</option>
        <option value="48">48</option>
        <option value="96">96</option>
      </select>
    </div>

    <div class="input-group">
      <label>Price (₹)</label>
      <select id="price" required>
        <option value="">Select Price</option>
        <option value="175">175</option>
        <option value="210">210</option>
        <option value="220">220</option>
        <option value="230">230</option>
        <option value="250">250</option>
        <option value="260">260</option>
        <option value="270">270</option>
        <option value="300">300</option>
              </select>
    </div>
    
    <button type="submit">Submit Entry</button>
  </form>

  <hr>

  <h2>Daru stock Entry/Exit</h2>
  <table id="itemsTable">
    <thead>
      <tr>
        <th>Date/Time</th>
        <th>Status</th>
        <th>Brand Name</th>
        <th>Qty</th>
        <th>Rate</th>
        <th>Total Value</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button class="clear-storage" onclick="clearAllData()">Reset System Memory</button>
</div>

<script>
    let inventory = [];
    
    try {
        const savedData = localStorage.getItem('myInventoryData');
        if (savedData) inventory = JSON.parse(savedData);
    } catch (e) { inventory = []; }

    function getBalance(itemName) {
        let balance = 0;
        inventory.forEach(item => {
            if (item.name === itemName) {
                const q = parseInt(item.quantity) || 0;
                balance += (item.type === 'EXIT' ? -q : q);
            }
        });
        return balance;
    }

    function checkAvailableStock() {
        const name = document.getElementById('name').value;
        const warningEl = document.getElementById('stockWarning');
        if (name) {
            const bal = getBalance(name);
            warningEl.innerText = `Stock: ${bal}`;
            warningEl.style.color = bal <= 0 ? "#dc3545" : "#28a745";
        } else {
            warningEl.innerText = "";
        }
    }

    function updateDashboard() {
        let currentStock = 0;
        let totalValue = 0;
        let uniqueNames = new Set();

        inventory.forEach(item => {
            const q = parseInt(item.quantity) || 0;
            const p = parseFloat(item.price) || 0;
            if (item.type === 'EXIT') {
                currentStock -= q;
                totalValue -= (q * p);
            } else {
                currentStock += q;
                totalValue += (q * p);
            }
            uniqueNames.add(item.name);
        });

        document.getElementById('totalQty').innerText = currentStock.toLocaleString('en-IN');
        document.getElementById('totalVal').innerText = '₹' + totalValue.toLocaleString('en-IN');
        document.getElementById('uniqueCount').innerText = uniqueNames.size;
    }

    function displayItems() {
      const tableBody = document.querySelector('#itemsTable tbody');
      tableBody.innerHTML = '';
      
      inventory.forEach((item, index) => {
        const row = document.createElement('tr');
        const q = parseInt(item.quantity);
        const p = parseFloat(item.price);
        const isExit = item.type === 'EXIT';

        row.innerHTML = `
          <td style="font-size: 0.8rem; color: #666;">${item.date}</td>
          <td><span class="badge ${isExit ? 'badge-exit' : 'badge-entry'}">${item.type}</span></td>
          <td style="font-weight: bold;">${item.name}</td>
          <td style="color: ${isExit ? 'red' : 'green'}; font-weight: bold;">${isExit ? '-' : '+'}${q}</td>
          <td>₹${p}</td>
          <td>₹${(isExit ? -(q*p) : (q*p)).toLocaleString('en-IN')}</td>
          <td><button class="delete-btn" onclick="deleteItem(${index})">Delete</button></td>
        `;
        tableBody.appendChild(row);
      });
      
      localStorage.setItem('myInventoryData', JSON.stringify(inventory));
      updateDashboard();
      checkAvailableStock();
    }

    document.getElementById('addForm').onsubmit = function(e) {
      e.preventDefault();
      
      const type = document.getElementById('type').value;
      const name = document.getElementById('name').value;
      const qty = parseInt(document.getElementById('quantity').value);
      const price = document.getElementById('price').value;
      
      if (type === 'EXIT') {
          const currentBalance = getBalance(name);
          if (qty > currentBalance) {
              alert(`Nahi hai! You only have ${currentBalance} units of ${name} in stock.`);
              return;
          }
      }

      const now = new Date();
      const dateString = now.toLocaleDateString() + ' ' + now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

      inventory.push({ date: dateString, type, name, quantity: qty, price });
      displayItems();
      this.reset();
      document.getElementById('stockWarning').innerText = "";
    };

    window.deleteItem = function(index) {
      if(confirm("Remove this record?")) {
        inventory.splice(index, 1);
        displayItems();
      }
    };

    function clearAllData() {
        if(confirm("Full Reset? Everything will be deleted.")) {
            localStorage.clear();
            inventory = [];
            displayItems();
        }
    }

    displayItems();
</script>
</body>
</html>
